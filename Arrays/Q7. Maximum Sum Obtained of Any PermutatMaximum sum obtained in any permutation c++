class Solution {
public:
    int maxSumRangeQuery(vector<int>& nums, vector<vector<int>>& requests) {
         int n = nums.size();
        vector<long long> freq(n + 1, 0);
        const int MOD = 1e9 + 7;

       
        for (auto &r : requests) {
            freq[r[0]]++;
            if (r[1] + 1 < n)
                freq[r[1] + 1]--;
        }

        // prefix sum to get count per index
        for (int i = 1; i < n; i++) {
            freq[i] += freq[i - 1];
        }

        freq.pop_back(); // remove extra element

        // sort both arrays
        sort(freq.begin(), freq.end());
        sort(nums.begin(), nums.end());

        long long ans = 0;
        for (int i = 0; i < n; i++) {
            ans = (ans + freq[i] * nums[i]) % MOD;
        }

        return ans;
    }
};
